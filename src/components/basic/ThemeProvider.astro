---

---

{/* 使用内联模式快速加载颜色，可避免闪烁 */}
<script is:inline>
  function simpleSetTheme() {
    let theme = localStorage.getItem('theme')
    // 若未定义或为 'system'，则从系统获取
    if (!theme || theme === 'system') {
      theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
    }
    document.documentElement.classList.toggle('dark', theme === 'dark')
    document
      .querySelector('meta[name="theme-color"]')
      ?.setAttribute('content', theme === 'dark' ? '#0B0B10' : '#FCFCFD')
  }
  simpleSetTheme()
  document.addEventListener('astro:page-load', () => simpleSetTheme())
</script>

<script>
  // 从 '../../libs/icons' 导入 { Icons }
  import { Icons } from '../../../node_modules/astro-pure/libs/icons'
  // 从 '../../utils' 导入 { listenThemeChange }
  import { listenThemeChange } from '../../../node_modules/astro-pure/utils'

  // 监听主题变化事件
  listenThemeChange()
  // 监听提示事件
  document.addEventListener('toast', (e) => {
    const { message } = (e as CustomEvent).detail
    const toast = document.createElement('div')
    toast.className =
      'animate fixed bottom-8 z-20 px-4 py-2 bg-muted text-foreground rounded-lg border shadow-lg flex items-center gap-2'
    toast.innerHTML = `<svg width='22' height='22' viewBox='0 0 24 24' fill='currentColor'>${Icons.info}</svg> <span>${message}</span>`
    document.body.appendChild(toast)
    setTimeout(() => {
      toast.remove()
    }, 3000)
  })
</script>
